<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Site.master.cs" Inherits="SiteMaster" %>


<html>

<head id="Head1" runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>


    <script type="text/javascript" src="<%=ResolveClientUrl("~/chromejs/chrome.js")%>">

    /***********************************************
    * Chrome CSS Drop Down Menu- (c) Dynamic Drive DHTML code library (www.dynamicdrive.com)
    * This notice MUST stay intact for legal use
    * Visit Dynamic Drive at http://www.dynamicdrive.com/ for full source code
    ***********************************************/

    </script>


    <%-- <link type="text/css" href="<%=ResolveClientUrl("menu.css")%>" rel="stylesheet" />
      <link href="<%=ResolveClientUrl("CSS/ThemeBlue.css")%>" rel="Stylesheet" type="text/css" />--%>

    <link type="text/css" href="menu.css" rel="stylesheet" />
    <link href="CSS/ThemeBlue.css" rel="Stylesheet" type="text/css" />

    <%--    <link href="CSS/ThemeBlue.css" rel="Stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>--%>


    <script src="<%=ResolveClientUrl("~/jquery/jquery-ui-1.8.1/jquery-1.4.2.js")%>" type="text/javascript"></script>
    <script src="<%=ResolveClientUrl("~/jquery/jquery-ui-1.8.1/ui/jquery-ui.js")%>" type="text/javascript"></script>
    <link href="<%=ResolveClientUrl("~/jquery/jquery-ui-1.8.1/themes/base/jquery.ui.theme.css")%>" rel="stylesheet" type="text/css" />
    <link href="<%=ResolveClientUrl("~/jquery/jquery-ui-1.8.1/themes/base/jquery-ui.css")%>" rel="stylesheet" type="text/css" />
    <script src="<%=ResolveClientUrl("~/js/jquery.numeric.js")%>" type="text/javascript"></script>
    <script src="<%=ResolveClientUrl("~/js/datapickerES.js")%>" type="text/javascript"></script>
    <script src="<%=ResolveClientUrl("~/jquery/jquery.getParams.js")%>" type="text/javascript"></script>
    <script src="<%=ResolveClientUrl("~/jquery/moment/moment.js")%>" type="text/javascript"></script>
    <script src="<%=ResolveClientUrl("~/js/main.js?11.0")%>" type="text/javascript"></script>

    <script src="<%=ResolveClientUrl("~/jquery/jquery.tablesorter.js")%>" type="text/javascript"></script>


    <script type="text/javascript">
        Operacion.block("<%=ResolveClientUrl("menu.aspx")%>" + "/bloqueo");
        var obtieneALCIAS = function () {
            var data = {};
            var oajax = Operacion.oAjax('CAlmacen.aspx/getALCIAS', data,null);
            $('#HFID').val(oajax.d.AC_CCIA);
        }


<%--        function validadireciones() {
            var urlactual = window.location.pathname;
            contaurl = 0;

            $.ajax({
                type: "POST",
                url: "<%=ResolveClientUrl("menu.aspx")%>/Getvalidaurl",
                data: "{codig:  '" + $("#hfusu").val() + "',nomurl:'" + urlactual + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.d != null || urlactual == '/menu.aspx') {
                        contaurl = 1;
                    } else {
                        contaurl = 0;
                    }
                },
                error: function (response) {
                    if (response.length != 0){
                        console.log(response);}
                    //console.log(urlactual);
                }
            });
            return { contaurl };
        }--%>




        function listaitems(menuitem) {
            listadatos = [];
            listaurl = [];
            nfilas = 0;

            $.ajax({
                type: "POST",
                url: "<%=ResolveClientUrl("menu.aspx")%>/Getmenulista",
                //url: "../menu.aspx/Getmenulista",
                data: "{codig:  '" + $("#hfusu").val() + "',menunom:'" + menuitem + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.d.length > 0) {
                        for (var i = 0; i < data.d.length; i++) {
                            listadatos[i] = data.d[i].NOMITEM;
                            listaurl[i] = data.d[i].URL;
                            nfilas++;
                        }
                    }
                },
                error: function (response) {
                    if (response.length != 0)
                        console.table(response);
                }
            });
        }

        function listacabeceras() {
            listadatoscab = [];
            ncolumnas = 0;
            $.ajax({

                type: "POST",
                url: "<%=ResolveClientUrl("menu.aspx")%>/Getmenumain",
            data: "{codig:  '" + $("#hfusu").val() + "'}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            success: function (data) {
                if (data.d.length > 0) {
                    for (var i = 0; i < data.d.length; i++) {
                        listadatoscab[i] = data.d[i].NOMMENU;
                        ncolumnas++;
                    }
                }
            },
            error: function (response) {
                if (response.length != 0)
                    console.table(response);
            }
        });
    }

    function listarmenu() {
        var logo = "<li><a href='#' class='parent'><span style='width:80px;margin:0 auto;text-align:center'><img src='<%=ResolveClientUrl("~/Images/logof.png")%>' width='75%'/></span></a>";
        var linicia = "<li><a href='#' class='parent'><span>";
        var lfinaliza = "<li>";
        var ulfinaliza = "</ul>";
        var nombremenu = ".menu01";
        var cadenaprincipal = "";
        var menuprin = "";
        var submenu = "";
        var menufinal = "";

        listacabeceras();
        for (var col = 0; col < ncolumnas; col++) {
            cadenaprincipal = logo + linicia + listadatoscab[col] + "</span></a>";
            logo = "";
            menuprin = cadenaprincipal + "<ul>";
            listaitems(listadatoscab[col]);
            for (var fil = 0; fil < nfilas ; fil++) {
                resurl = listaurl[fil];

                var urlactual = window.location.host;

                urlactual = urlactual.substring(0, 9);
                if (urlactual != "localhost") {
                    submenu = submenu + (menuprin + "<li><a href='" + resurl + "'><span>" + listadatos[fil] + "</span></a></li>");
                }
                else {
                    submenu = submenu + (menuprin + "<li><a href='" + resurl.replace("/SEALOGISTICA", "") + "'><span>" + listadatos[fil] + "</span></a></li>");
                }
                menuprin = "";
            }
            $(nombremenu).append(submenu + ulfinaliza + lfinaliza);

            submenu = "";
        }
        $(nombremenu).append("<li class='last'><a href=<%=ResolveClientUrl("default.aspx")%>><span>Cerrar Sesión</span></a></li>");
           }



           $(function () {
               //NO ES NECESARIO validadirecciones
               //var contaur = validadireciones().contaurl;
               listarmenu();
               //if (contaur > 0) {
               //    listarmenu();
               //} else {
               //    window.location.assign("../menu.aspx");
               //}
           });



    </script>



    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        div#menu {
            margin: 5px auto;
        }

        div#copyright {
            font: 11px 'Trebuchet MS';
            color: #222;
            text-indent: 30px;
            padding: 40px 0 0 0;
        }

            div#copyright a {
                color: #eee;
            }

                div#copyright a:hover {
                    color: #222;
                }
    </style>

    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>


</head>

<body style="background-position: center center; background-image: url(<%=ResolveClientUrl("Images/logoseafrost2.jpg")%>); background-repeat: no-repeat; background-color: #0769ad;">


    <form runat="server">
        <div class="page">
            <asp:HiddenField ID="hfusu" runat="server" EnableViewState="false" />
            <div class="header">

                <div class="loginDisplay">

                    <asp:LoginView ID="HeadLoginView" runat="server" EnableViewState="false">
                        <AnonymousTemplate>
                        </AnonymousTemplate>
                        <LoggedInTemplate>
                            Bienvenido <span class="bold">
                                <asp:LoginName ID="HeadLoginName" runat="server" />
                            </span>!
                        [
                            <asp:LoginStatus ID="HeadLoginStatus" runat="server" LogoutAction="Redirect" LogoutText="Cerra Sesión" LogoutPageUrl="~/" />
                            ]
                        </LoggedInTemplate>
                    </asp:LoginView>
                </div>
                <div class="clear hideSkiplink">

                    <div id="menu">
                        <ul class="menu01">


                            <%-- <li><a href="#" class="parent"><span>Logistica</span></a>
                                <ul>
                                    <li><a href="<%=ResolveClientUrl("REQUERIMIENTOS/listadoOC.aspx") %>"><span>Listado de Requerimientos</span></a></li>
                                    <li><a href="<%=ResolveClientUrl("REQUERIMIENTOS/apruebaRequerimiento.aspx") %>"><span>Aprobación de Requerimientos</span></a></li>
                                    <li><a href="#" class="parent"><span>otros</span></a>
                                        <ul>
                                            <li><a href="<%=ResolveClientUrl("REQUERIMIENTOS/ocreq.aspx") %>"><span>Orden de compra contra requerimiento</span></a></li>
                                        </ul>
                                    </li>
                                    <li><a href="<%=ResolveClientUrl("ORDENCOMPRA/OCemision.aspx") %>"><span>Registro de Orden Compra</span></a></li>
                                </ul>
                            </li>
                            <li class="last"><a href="<%=ResolveClientUrl("default.aspx") %>"><span>Cerrar Sesión</span></a></li>
                            --%>
                        </ul>
                    </div>





                </div>
            </div>

            <div class="main">
                <asp:ContentPlaceHolder ID="MainContent" runat="server" />
                <!--Agregar a site maste principal-->
                <asp:HiddenField ID="HFFB" runat="server" />
                <asp:HiddenField ID="HFID" runat="server" />
            </div>
            <div class="clear">
            </div>
        </div>
        <div class="footer">
            <div id="copyright"><a href="http://apycom.com/"></a></div>
        </div>
    </form>
</body>
</html>
