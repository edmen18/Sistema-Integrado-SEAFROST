namespace ENTITY
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;
    using System.ComponentModel.DataAnnotations.Schema;
    using System.Data.Entity;
    using System.Linq;
    using System.Data.Entity.Spatial;
    using System.Data.Entity.Validation;
    using System.Diagnostics;
     
    public partial class OT_CO0003MOVC
    {
        [Key]
        [StringLength(20)]
        public string OC_CNUMORD { get; set; }

        
        [StringLength(18)]
        public string OC_CCODPRO { get; set; }

        
        [StringLength(80)]
        public string OC_CRAZSOC { get; set; }

        
        [StringLength(80)]
        public string OC_CDIRPRO { get; set; }

        
        [StringLength(30)]
        public string OC_CCOTIZA { get; set; }

        
        [StringLength(2)]
        public string OC_CCODMON { get; set; }

        
        [StringLength(30)]
        public string OC_CFORPA1 { get; set; }

        
        [StringLength(30)]
        public string OC_CFORPA2 { get; set; }

        
        [StringLength(30)]
        public string OC_CFORPA3 { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NTIPCAM { get; set; }

        public DateTime? OC_DFECENT { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NPORDES { get; set; }

        
        [StringLength(80)]
        public string OC_CCARDES { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPUS { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPMN { get; set; }

        
        [StringLength(50)]
        public string OC_CSOLICT { get; set; }

        
        [StringLength(80)]
        public string OC_CTIPENV { get; set; }

        
        [StringLength(80)]
        public string OC_CLUGENT { get; set; }

        
        [StringLength(80)]
        public string OC_CLUGFAC { get; set; }

        
        [StringLength(80)]
        public string OC_CDETENT { get; set; }

        
        [StringLength(1)]
        public string OC_CSITORD { get; set; }

        public DateTime? OC_DFECACT { get; set; }

        
        [StringLength(8)]
        public string OC_CHORA { get; set; }

        
        [StringLength(5)]
        public string OC_CUSUARI { get; set; }

        public DateTime? OC_DFECDOC { get; set; }

        
        [StringLength(1)]
        public string OC_CTIPORD { get; set; }

        
        [StringLength(30)]
        public string OC_CRESPER1 { get; set; }

        
        [StringLength(30)]
        public string OC_CRESPER2 { get; set; }

        
        [StringLength(30)]
        public string OC_CRESPER3 { get; set; }

        
        [StringLength(30)]
        public string OC_CRESCARG1 { get; set; }

        
        [StringLength(30)]
        public string OC_CRESCARG2 { get; set; }

        
        [StringLength(30)]
        public string OC_CRESCARG3 { get; set; }

        
        [StringLength(4)]
        public string OC_CCOPAIS { get; set; }

        
        [StringLength(5)]
        public string OC_CUSEA01 { get; set; }

        
        [StringLength(5)]
        public string OC_CUSEA02 { get; set; }

        
        [StringLength(5)]
        public string OC_CUSEA03 { get; set; }

        public DateTime? OC_DFECR01 { get; set; }

        public DateTime? OC_DFECR02 { get; set; }

        public DateTime? OC_DFECR03 { get; set; }

        
        [StringLength(40)]
        public string OC_CREMITE { get; set; }

        
        [StringLength(40)]
        public string OC_CPERATE { get; set; }

        
        [StringLength(25)]
        public string OC_CCONTA1 { get; set; }

        
        [StringLength(25)]
        public string OC_CCONTA2 { get; set; }

        
        [StringLength(25)]
        public string OC_CCONTA3 { get; set; }

        
        [StringLength(20)]
        public string OC_CNUMFAC { get; set; }

        public DateTime? OC_DFECEMB { get; set; }

        
        [StringLength(1)]
        public string OC_CUNIORD { get; set; }

        
        [StringLength(4)]
        public string OC_CCONVTA { get; set; }

        
        [StringLength(4)]
        public string OC_CCONEMB { get; set; }

        
        [StringLength(2)]
        public string OC_CCONDIC { get; set; }

        
        [StringLength(2)]
        public string OC_CTIPENT { get; set; }

        
        [StringLength(4)]
        public string OC_CDIAENT { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NFLEINT { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NDOCCHA { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NFLETE { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NSEGURO { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPFAC { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPFOB { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPCF { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPCIF { get; set; }

        
        [StringLength(20)]
        public string OC_CNUMREF { get; set; }

        
        [StringLength(3)]
        public string OC_CTIPDSP { get; set; }

        
        [StringLength(2)]
        public string OC_CTIPDOC { get; set; }

        
        [StringLength(4)]
        public string OC_CALMDES { get; set; }

        
        [StringLength(15)]
        public string OC_CDISTOC { get; set; }

        
        [StringLength(40)]
        public string OC_CPROVOC { get; set; }

        
        [StringLength(6)]
        public string OC_CCOSTOC { get; set; }

        
        [StringLength(20)]
        public string OC_CDOCPAG { get; set; }

        public DateTime? OC_DFECPAG { get; set; }

        public DateTime? OC_DFECVEN { get; set; }

        
        [StringLength(1)]
        public string OC_CESTPAG { get; set; }

        
        [StringLength(2)]
        public string OC_CMONPAG { get; set; }

        [Column(TypeName = "numeric")]
        public decimal OC_NIMPPAG { get; set; }

        
        [StringLength(50)]
        public string OC_CGLOPAG { get; set; }

        
        [StringLength(12)]
        public string OC_CCODSOL { get; set; }

        
        [StringLength(4)]
        public string OC_CCODAGE { get; set; }

        
        [StringLength(4)]
        public string OC_CCODTAL { get; set; }

        
        [StringLength(11)]
        public string OC_CORDTRA { get; set; }

        public static void InsertarCabeceraOT(OT_CO0003MOVC ADDMC)
        {
            try
            {
                using (var ctx = new ANEXO_RSFACAR())
                {
                    ctx.Entry(ADDMC).State = EntityState.Added;
                    ctx.SaveChanges();
                }
            }
            catch 
            {
                using (ANEXO_RSFACAR ctxM = new ANEXO_RSFACAR())
                {
                    ctxM.Entry(ADDMC).State = EntityState.Modified;
                    ctxM.SaveChanges();
                }
            }
        }



        public static List<reporte_ordencrys> OCreporteOT(OT_CO0003MOVC COM)
        {
            var Listarep = new List<reporte_ordencrys>();
            var subrimport = new CO0003MOVI();
            var A_TELE = ""; var A_CONTAC = "";
            using (var ctxconcar = new RSCONCAR())
            {
                try
                {
                    A_TELE = ((from n in ctxconcar.CT0003ANEX
                               where n.ACODANE.Trim() == COM.OC_CCODPRO.Trim() && n.AVANEXO == "P"
                               select new { n.ATELEFO }).FirstOrDefault().ATELEFO);
                }
                catch { A_TELE = ""; }

                try
                {
                    A_CONTAC = ((from r in new RSCONCAR().CP0003MAEC
                                 where r.CP_CCODIGO.Trim() == COM.OC_CCODPRO.Trim()
                                 select new { r.CP_CNOMBRE }).FirstOrDefault().CP_CNOMBRE);
                }
                catch { A_CONTAC = ""; }
            }

           

                //using (RSFACAR ctx = new RSFACAR())
                //{
                    using (ANEXO_RSFACAR ctxax = new ANEXO_RSFACAR())
                    {

                    //subrimport = (from n in ctx.CO0003MOVI where n.OC_CNUMORD == COM.OC_CNUMORD select n).FirstOrDefault();

                    Listarep = (from a in ctxax.OT_CO0003MOVC
                                join b in ctxax.OT_CO0003MOVD on a.OC_CNUMORD equals b.OC_CNUMORD
                                where a.OC_CNUMORD == COM.OC_CNUMORD
                                select new
                                {
                                    data1 = a.OC_CNUMORD,
                                    data2 = a.OC_CCODPRO,
                                    data3 = a.OC_CRAZSOC,
                                    data4 = a.OC_CDIRPRO,
                                    data5 = a.OC_CCOTIZA,
                                    data6 = a.OC_CCODMON,
                                    data7 = a.OC_CFORPA1.ToUpper(),
                                    data8 = a.OC_DFECACT,
                                    data9 = a.OC_CUSUARI.Trim(),//ususario
                                    data10 = a.OC_DFECDOC,
                                    data11 = a.OC_DFECENT,
                                    data12 = (a.OC_CCOSTOC.Trim()),//centro costro
                                    data13 = a.OC_CLUGENT,
                                    data14 = a.OC_CDETENT,
                                    data15 = a.OC_CTIPDOC,
                                    data16 = a.OC_CTIPORD.Trim(),//((from t in ctx.AL0003TABL where t.TG_CCOD.Trim() == "63" && t.TG_CCLAVE.Trim() ==  select new { t.TG_CDESCRI }).FirstOrDefault().TG_CDESCRI),//forma tiposervicio
                                    data17 = a.OC_CSITORD,// ((from r in ctx.AL0003TABL where r.TG_CCOD.Trim() == "31" && r.TG_CCLAVE.Trim() ==  select new { r.TG_CDESCRI }).FirstOrDefault().TG_CDESCRI), // estado orden
                                    data18 = a.OC_NIMPUS,
                                    data19 = a.OC_NIMPMN,
                                    data20 = b.OC_CCODIGO,
                                    data21 = (b.OC_CCODIGO.Trim()), //descripcion articuloo, 
                                    data22 = b.OC_CNUMREQ,
                                    data23 =( b.OC_CCENCOS.Trim()),//centro costo d
                                    data24 = b.OC_CSOLICI,//((from t in ctx.AL0003TABL where t.TG_CCOD.Trim() == "12" && t.TG_CCLAVE.Trim() == select new { t.TG_CDESCRI }).FirstOrDefault().TG_CDESCRI),
                                    data25 = b.OC_CUNIDAD,
                                    data26 = b.OC_NCANORD,
                                    data27 = b.OC_NPREUN2,
                                    data28 = b.OC_NIGV,
                                    data29 = b.OC_NTOTUS,
                                    data30 = b.OC_NTOTMN,
                                    data31 = "",// ((from r in ctx.ALCIAS where r.AC_CCIA.Trim() == "0003" select new { r.AC_CNOMCIA }).FirstOrDefault().AC_CNOMCIA), //empresa
                                    data32 = "",//((from r in ctx.ALCIAS where r.AC_CCIA.Trim() == "0003" select new { r.AC_CRUC }).FirstOrDefault().AC_CRUC), //RUC
                                    data33 = "",//((from r in ctx.ALCIAS where r.AC_CCIA.Trim() == "0003" select new { r.AC_CDIRCIA }).FirstOrDefault().AC_CDIRCIA), //DIRECCION
                                    data34 = A_CONTAC, //contacto 
                                    data35 = A_TELE, //telefno
                                    data36 = a.OC_CTIPORD,
                                    data37 = b.OC_NDESCTO,
                                    data38 = b.OC_NDESCAD,
                                    data39 = a.OC_CUSEA01.Trim(),//((from r in ctx.UT0030 where r.TU_ALIAS.Trim() == a.OC_CUSEA01.Trim() select new { r.TU_NOMUSU }).FirstOrDefault().TU_NOMUSU),//a.OC_CUSEA01,
                                    data40 = a.OC_CUSEA02.Trim(),//((from r in ctx.UT0030 where r.TU_ALIAS.Trim() == a.OC_CUSEA02.Trim() select new { r.TU_NOMUSU }).FirstOrDefault().TU_NOMUSU),//a.OC_CUSEA02,
                                    data41 = a.OC_CUSEA03.Trim(),//((from r in ctx.UT0030 where r.TU_ALIAS.Trim() == a.OC_CUSEA03.Trim() select new { r.TU_NOMUSU }).FirstOrDefault().TU_NOMUSU),//a.OC_CUSEA03
                                    data42 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTNOMC }).FirstOrDefault().OC_CSTNOMC),
                                    data43 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTPAIS }).FirstOrDefault().OC_CSTPAIS),//OC_CSTPAIS),
                                    data44 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTDIRC }).FirstOrDefault().OC_CSTDIRC),//.OC_CSTDIRC),
                                    data45 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTTELC }).FirstOrDefault().OC_CSTTELC),//OC_CSTTELC),
                                    data46 = "",//((from r in ctx.CO0003MOVI  where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTFAXC }).FirstOrDefault().OC_CSTFAXC),//OC_CSTFAXC),
                                    data47 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CSTPERA }).FirstOrDefault().OC_CSTPERA),//OC_CSTPERA),
                                    data48 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CCTNOMC }).FirstOrDefault().OC_CCTNOMC),//OC_CCTNOMC),
                                    data49 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD select new { r.OC_CCTPAIS }).FirstOrDefault().OC_CCTPAIS),//OC_CCTPAIS),
                                    data50 = "",//((from r in ctx.CO0003MOVI where r.OC_CNUMORD == COM.OC_CNUMORD
                                    data51 = "",
                                    data52 = "",
                                    data53 = "",
                                    data54 = b.OC_CCODIGO.Trim(),//((from r in ctx.AL0003ARTI where r.AR_CCODIGO.Trim() == b.OC_CCODIGO.Trim() select new { r.AR_CLINEA }).FirstOrDefault().AR_CLINEA), //grupo articulo
                                    data55 = (b.OC_COMENTA), //OBSERVACION
                                    data56 = b.OC_CCENCOS,//centro costo codigo

                                }).ToList().Select(c => new reporte_ordencrys()
                                {
                                    OC_CNUMORD = c.data1,
                                    OC_CCODPRO = c.data2,
                                    OC_CRAZSOC = c.data3,
                                    OC_CDIRPRO = c.data4,
                                    OC_CCOTIZA = c.data5,
                                    OC_CCODMON = c.data6,
                                    OC_CFORPA1 = c.data7,
                                    OC_DFECACT = String.Format("{0:dd/MM/yyyy}", c.data8),
                                    SC_CUSUARI = UT0030.Mostrarunusuario(c.data9).ToString(), //SC_CUSUARI = ((from t in ctx.UT0030 where t.TU_ALIAS.Trim() == c.data9 select new { t.TU_NOMUSU }).FirstOrDefault().TU_NOMUSU),
                                    OC_DFECDOC = String.Format("{0:dd/MM/yyyy}", c.data10),
                                    OC_DFECENT = String.Format("{0:dd/MM/yyyy}", c.data11),
                                    SC_CCOSTOC = AL0003TABL.Registrouno(c.data12, "10").ToString(),//((from t in ctx.AL0003TABL where t.TG_CCOD.Trim() == "10" && t.TG_CCLAVE.Trim() == c.data12 select new { t.TG_CDESCRI }).FirstOrDefault().TG_CDESCRI),
                                    OC_CLUGENT = c.data13,
                                    OC_CDETENT = c.data14,
                                    SC_CTIPDOC = c.data15,
                                    SC_CTIPORD = AL0003TABL.Registrouno(c.data16, "63").ToString(),
                                    SC_CSITORD = AL0003TABL.Registrouno(c.data17, "31").ToString(),
                                    OC_NIMPUS = c.data18,
                                    OC_NIMPMN = c.data19,
                                    OC_CCODIGO = c.data20,
                                    OC_CDESREF = (AL0003ARTI.obtenerArticuloPorID(c.data21).AR_CDESCRI).ToString(), //((from r in ctx.AL0003ARTI  where r.AR_CCODIGO.Trim() == c.data21 select new { r.AR_CDESCRI }).FirstOrDefault().AR_CDESCRI),
                                    OC_CNUMREQ = c.data22,
                                    SC_CCENCOS = AL0003TABL.Registrouno(c.data23, "10").ToString() ,
                                    SC_CSOLICI = AL0003TABL.Registrouno(c.data24, "12").ToString(),
                                    OC_CUNIDAD = c.data25,
                                    OC_NCANORD = c.data26,
                                    OC_NPREUN2 = c.data27,
                                    OC_NIGV = c.data28,
                                    OC_NTOTUS = c.data29,
                                    OC_NTOTMN = c.data30,
                                    SC_EMPRESA = ALCIAS.Verciasdato().AC_CNOMCIA,
                                    SC_RUC = ALCIAS.Verciasdato().AC_CRUC,
                                    SC_DIREC = ALCIAS.Verciasdato().AC_CDIRCIA,
                                    SC_TELE = c.data34,
                                    SC_CONTAC = c.data35,
                                    OC_CTIPORD = c.data36,
                                    OC_NDESCTO = c.data37,
                                    OC_NDESCAD = c.data38,
                                    OC_CUSEA01 = UT0030.Mostrarunusuario(c.data39).ToString(),
                                    OC_CUSEA02 = UT0030.Mostrarunusuario(c.data40).ToString(),
                                    OC_CUSEA03 = UT0030.Mostrarunusuario(c.data41).ToString(),
                                    OC_CSTNOMC = c.data42,
                                    OC_CSTPAIS = c.data43,
                                    OC_CSTDIRC = c.data44,
                                    OC_CSTTELC = c.data45,
                                    OC_CSTFAXC = c.data46,
                                    OC_CSTPERA = c.data47,
                                    OC_CCTNOMC = c.data48,
                                    OC_CCTPAIS = c.data49,
                                    OC_CCTDIRC = c.data50,
                                    OC_CCTTELC = c.data51,
                                    OC_CCTFAXC = c.data52,
                                    OC_CCTPERA = c.data53,
                                    OC_GRUPO = (AL0003ARTI.obtenerArticuloPorID(c.data54).AR_CLINEA).ToString(),
                                    OC_COMENTA = c.data55,
                                    OC_CCENCOS = c.data56
                                }).ToList();

                       //}
                }
            
            return Listarep;
            
        }
    }
}
